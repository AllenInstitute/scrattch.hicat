<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rename clusters using genes and metadata — renameAndOrderClusters • scrattch.hicat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Rename clusters using genes and metadata — renameAndOrderClusters"><meta property="og:description" content="This function uses information from both the data (gene expression) and meta-data
  (annotation) objects to build a useful automated cluster name."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scrattch.hicat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/scrattch.hicat_release.html">Overview of scrattch hicat</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AllenInstitute/scrattch.hicat/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rename clusters using genes and metadata</h1>
    <small class="dont-index">Source: <a href="https://github.com/AllenInstitute/scrattch.hicat/blob/HEAD/R/human_functions_rename.r" class="external-link"><code>R/human_functions_rename.r</code></a></small>
    <div class="hidden name"><code>renameAndOrderClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses information from both the data (gene expression) and meta-data
  (annotation) objects to build a useful automated cluster name.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">renameAndOrderClusters</span><span class="op">(</span></span>
<span>  <span class="va">sampleInfo</span>,</span>
<span>  classNameColumn <span class="op">=</span> <span class="st">"cluster_type_label"</span>,</span>
<span>  classGenes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GAD1"</span>, <span class="st">"SLC17A7"</span>, <span class="st">"SLC1A3"</span><span class="op">)</span>,</span>
<span>  classLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inh"</span>, <span class="st">"exc"</span>, <span class="st">"glia"</span><span class="op">)</span>,</span>
<span>  layerNameColumn <span class="op">=</span> <span class="st">"layer_label"</span>,</span>
<span>  regionNameColumn <span class="op">=</span> <span class="st">"Region_label"</span>,</span>
<span>  matchNameColumn <span class="op">=</span> <span class="st">"cellmap_label"</span>,</span>
<span>  newColorNameColumn <span class="op">=</span> <span class="st">"cellmap_color"</span>,</span>
<span>  otherColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  propLayer <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  dend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  orderbyColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"layer"</span>, <span class="st">"region"</span>, <span class="st">"topMatch"</span><span class="op">)</span>,</span>
<span>  includeClusterCounts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  includeBroadGenes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  broadGenes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  includeSpecificGenes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  propExpr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  medianExpr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  propDiff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  propMin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  medianFC <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  excludeGenes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sortByMedian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"_"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-sampleinfo">sampleInfo<a class="anchor" aria-label="anchor" href="#arg-sampleinfo"></a></dt>
<dd><p>Sample information with rows as samples and columns for annotations.
All samples in sampleInfo are used for renaming (so subset prior to running this function
if desired). Columns must include "cluster_id", "cluster_label", and "cluster_color".</p></dd>


<dt id="arg-classnamecolumn">classNameColumn<a class="anchor" aria-label="anchor" href="#arg-classnamecolumn"></a></dt>
<dd><p>Column name where class information is stored (e.g., inh/exc/glia),
or NULL if you'd like it to be defined based on <code>classGenes</code></p></dd>


<dt id="arg-classgenes">classGenes<a class="anchor" aria-label="anchor" href="#arg-classgenes"></a></dt>
<dd><p>Set of genes for defining classes (which is ignored in this context
if <code>classNameColumn!=NULL</code>). Also used if <code>broadClass</code> gene is not expressed.</p></dd>


<dt id="arg-classlevels">classLevels<a class="anchor" aria-label="anchor" href="#arg-classlevels"></a></dt>
<dd><p>A vector of the levels for classes of the same length (and in the same
order) as classGenes.  Either include all relevant levels or set to NA for none if using
<code>classNameColumn</code></p></dd>


<dt id="arg-layernamecolumn">layerNameColumn<a class="anchor" aria-label="anchor" href="#arg-layernamecolumn"></a></dt>
<dd><p>Column name where the (numeric) layer info is stored (NA if none)</p></dd>


<dt id="arg-regionnamecolumn">regionNameColumn<a class="anchor" aria-label="anchor" href="#arg-regionnamecolumn"></a></dt>
<dd><p>Column name where the (character) region info is stored (NA if none)</p></dd>


<dt id="arg-matchnamecolumn">matchNameColumn<a class="anchor" aria-label="anchor" href="#arg-matchnamecolumn"></a></dt>
<dd><p>Column name where the (character) comparison info stored (e.g.,
closest mapping cell type for each cell pre-calculated against a previous taxonomy; NA if none)</p></dd>


<dt id="arg-newcolornamecolumn">newColorNameColumn<a class="anchor" aria-label="anchor" href="#arg-newcolornamecolumn"></a></dt>
<dd><p>Column name where the new cluster colors are found (e.g., color
column corresponding to <code>matchNameColumn</code>). NA keeps the current colors.</p></dd>


<dt id="arg-othercolumns">otherColumns<a class="anchor" aria-label="anchor" href="#arg-othercolumns"></a></dt>
<dd><p>Other columns to transfer to the output variable.  Note that the value from
a random sample in the cluster is returned, so this usually should be left as default (NULL).</p></dd>


<dt id="arg-proplayer">propLayer<a class="anchor" aria-label="anchor" href="#arg-proplayer"></a></dt>
<dd><p>Proportion of cells (relative to max) must be higher than this for a cluster
to be considered as expressed in a particular layer (default is 0.3).</p></dd>


<dt id="arg-dend">dend<a class="anchor" aria-label="anchor" href="#arg-dend"></a></dt>
<dd><p>Dendrogram object, only used for ordering of clusters (NULL as default)</p></dd>


<dt id="arg-orderbycolumns">orderbyColumns<a class="anchor" aria-label="anchor" href="#arg-orderbycolumns"></a></dt>
<dd><p>column names indicating the outputted cluster order (not used unless
dend=NULL).  Must be some combination of "layer", "region", and "topMatch" in any order (or
NULL).  Default is first by "layer" than "region" then "topMatch".</p></dd>


<dt id="arg-includeclustercounts">includeClusterCounts<a class="anchor" aria-label="anchor" href="#arg-includeclustercounts"></a></dt>
<dd><p>Should the number of cells in each cluster be included in name?</p></dd>


<dt id="arg-includebroadgenes">includeBroadGenes<a class="anchor" aria-label="anchor" href="#arg-includebroadgenes"></a></dt>
<dd><p>Should broad genes be included in the name (if so, <code>broadGenes</code>
must be provided)?</p></dd>


<dt id="arg-broadgenes">broadGenes<a class="anchor" aria-label="anchor" href="#arg-broadgenes"></a></dt>
<dd><p>List of broad genes, where the top median CPM in cluster is included in name</p></dd>


<dt id="arg-includespecificgenes">includeSpecificGenes<a class="anchor" aria-label="anchor" href="#arg-includespecificgenes"></a></dt>
<dd><p>Should specific genes be included in the name?  If TRUE, the next
seven parameters are used to call <code>getTopMarkersByPropNew</code>.</p></dd>


<dt id="arg-propexpr">propExpr<a class="anchor" aria-label="anchor" href="#arg-propexpr"></a></dt>
<dd><p>matrix of proportions of cells expressing a gene in each cluster
(genes=rows, clusters=columns)</p></dd>


<dt id="arg-medianexpr">medianExpr<a class="anchor" aria-label="anchor" href="#arg-medianexpr"></a></dt>
<dd><p>matrix of median expression per cluster (genes=rows, clusters=columns)</p></dd>


<dt id="arg-propdiff">propDiff<a class="anchor" aria-label="anchor" href="#arg-propdiff"></a></dt>
<dd><p>Must have difference in proportion higher than this value in "on" cluster
compared with each other cluster</p></dd>


<dt id="arg-propmin">propMin<a class="anchor" aria-label="anchor" href="#arg-propmin"></a></dt>
<dd><p>Must have higher proportion in "on" cluster</p></dd>


<dt id="arg-medianfc">medianFC<a class="anchor" aria-label="anchor" href="#arg-medianfc"></a></dt>
<dd><p>Must have median fold change greater than this value in "on" group vs.
each other cluster</p></dd>


<dt id="arg-excludegenes">excludeGenes<a class="anchor" aria-label="anchor" href="#arg-excludegenes"></a></dt>
<dd><p>Genes exlcuded from marker consideration (NULL by default)</p></dd>


<dt id="arg-sortbymedian">sortByMedian<a class="anchor" aria-label="anchor" href="#arg-sortbymedian"></a></dt>
<dd><p>Should genes passing all filters be prioritized by median fold
change (TRUE, default) or by difference in proportion between clusters (FALSE)</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>Separation character for renaming (default is "_")</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame of cluster information, which includes the new and old names, the
  requested variables from sampleInfo, and all the specific components of the new name.
  This is the required input for <code>updateSampDat</code> in the appropriate format.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>When all options are selected, the outputed format is as follows: [cell class]_[layer
  range]_[broad marker gene]_[specific marker gene]_[brain region with most cells (and
  scaled fraction of cells)]_[best matched type from previous taxonomy]_[number of cells
  in cluster].  The output is a data frame with information about each cluster, including
  the new cluster names.  <code>updateSampDat</code> needs to be run after <code>renameAndOrderClusters</code>
  to apply the new cluster names to each sample.  If a dendrogram has already been
  created, the dendrogram labels will also need to be changed separately.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zizhen Yao, Lucas Graybuck, Trygve Bakken, Cindy van Velthoven, Jeremy Miller, Adriana Sedeno-Cortes, Changkyu Lee, Lawrence Huang, Saroja Somasundaram.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

